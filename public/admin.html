<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ê–¥–º–∏–Ω ‚Äî T‚ÄëBank (Dark)</title>
  <link rel="stylesheet" href="/admin.css" />

  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#007bff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="–û—á–µ—Ä–µ–¥–∏">

  <!-- Icons -->
  <link rel="icon" href="/icon-192.png">
  <link rel="apple-touch-icon" href="/icon-192.png">

  <!-- Manifest -->
  <link rel="manifest" href="/manifest.json">
</head>
<body class="admin-body">
  <header class="admin-header">
    <div class="left">
      <img src="/images/T-Bank_logo_rus_left_white shield_black text_yellow bg.svg" alt="logo" class="admin-logo">
      <h1>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
    </div>
    <div class="right">
      <button id="btnAdd" class="btn btn-accent">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ—á–∫—É</button>
    </div>
  </header>

  <!-- –ö–ù–û–ü–ö–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ë–ê–ó–û–ô -->
  <div style="margin: 20px; padding: 20px; background: #2d3748; border-radius: 10px; border: 2px solid #4a5568;">
    <h3 style="margin-top: 0; color: #e2e8f0;">‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö</h3>
    
    <button onclick="clearTickets()" 
            style="padding: 12px 20px; margin: 5px; background: #e53e3e; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">
        üóë –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–∞–ª–æ–Ω—ã
    </button>
    
    <button onclick="resetDatabase()" 
            style="padding: 12px 20px; margin: 5px; background: #d69e2e; color: black; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">
        üîÑ –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –±–∞–∑—ã
    </button>
    
    <p style="margin: 10px 0 0 0; font-size: 14px; color: #a0aec0;">
        ‚ö†Ô∏è –û—Å—Ç–æ—Ä–æ–∂–Ω–æ: –¥–µ–π—Å—Ç–≤–∏—è –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!
    </p>
  </div>

  <main class="admin-main">
    <div id="cards" class="cards-grid" aria-live="polite"></div>
  </main>

  <!-- Edit Modal -->
  <div id="modal-root"></div>

  <template id="card-template">
    <article class="card">
      <div class="card-body">
        <div class="card-top">
          <div class="title-wrap">
            <div class="name"></div>
            <div class="sector muted"></div>
          </div>
          <div class="counts">
            <div class="queued muted">‚Äî</div>
            <div class="max muted">max: ‚Äî</div>
          </div>
        </div>
        <p class="desc muted small"></p>
      </div>
      <div class="card-actions">
        <button class="btn btn-ghost btn-edit">‚úèÔ∏è –†–µ–¥.</button>
        <button class="btn btn-danger btn-delete">üóë –£–¥–∞–ª–∏—Ç—å</button>
      </div>
    </article>
  </template>

  <script>
// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –±–∞–∑—ã
function clearTickets() {
    if (!confirm('‚ùå –£–¥–∞–ª–∏—Ç—å –í–°–ï —Ç–∞–ª–æ–Ω—ã? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) return;
    
    fetch('/api/admin/clear-tickets', { method: 'DELETE' })
        .then(response => response.json())
        .then(data => {
            alert(`‚úÖ –û—á–∏—â–µ–Ω–æ —Ç–∞–ª–æ–Ω–æ–≤: ${data.deleted}`);
            location.reload();
        })
        .catch(err => {
            alert('‚ùå –û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏: ' + err);
        });
}

function resetDatabase() {
    if (!confirm('‚ö†Ô∏è –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –±–∞–∑—ã? –£–¥–∞–ª—è—Ç—Å—è –í–°–ï —Ç–∞–ª–æ–Ω—ã –∏ —Ç–æ—á–∫–∏, –∑–∞—Ç–µ–º —Å–æ–∑–¥–∞–¥—É—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ç–æ—á–∫–∏!')) return;
    
    fetch('/api/admin/reset-db', { method: 'DELETE' })
        .then(response => response.json())
        .then(data => {
            alert('‚úÖ –ë–∞–∑–∞ —Å–±—Ä–æ—à–µ–Ω–∞ –¥–æ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è');
            location.reload();
        })
        .catch(err => {
            alert('‚ùå –û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞: ' + err);
        });
}
  </script>

  <script type="module" src="/admin.js"></script>
</body>
</html>
